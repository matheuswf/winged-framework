<?php$this->html('_includes/navbar');$this->html('_includes/content');$this->html('_includes/menu');use Winged\Http\Session;use Winged\Model\Login;use Winged\Model\Clientes;use Winged\Model\EnderecosClientes;use Winged\Model\Estados;use Winged\Database\DbDict;use Winged\Model\Cidades;use Winged\Form\Form;use Winged\Model\Model;?>    <div class="content-wrapper">        <div class="page-header page-header-default">            <div class="page-header-content">                <div class="page-title">                    <h4><?= $this->page_name ?></h4>                </div>            </div>            <div class="breadcrumb-line">                <ul class="breadcrumb">                    <li class="active"><?= $this->page_action_string ?></li>                </ul>            </div>        </div>        <div class="content">            <?php            /**             * @var $model Model             */            /**             * @var $endereco Model             */            if ($model->hasErrors()) {                ?>                <div style="margin-top: 10px" class="col-lg-12">                    <div class="panel panel-danger">                        <div class="panel-heading">                            <h6 class="panel-title"><i class="icon-check"></i> Registro não pode ser salvo</h6>                        </div>                        <div class="panel-body">                            <h6 class="no-margin">                                <small class="display-block" style="margin-bottom:10px">                                    Sua última ação de alteração ou inserção não pode ser executada porquê o sistema                                    encontrou erros ao validar os dados enviados.                                </small>                            </h6>                        </div>                    </div>                </div>                <?php            }            $form = new Form($model);            $form_endereco = new Form($endereco);            ?>            <div class="page-container">                <div class="page-content">                    <div class="content-wrapper">                        <div class="content">                            <div class="row">                                <?= $form->begin((\Admin::isInsert() ? $this->insert : $this->update . uri('id')), 'post', [], 'multipart/form-data', true); ?>                                <?php                                if ($model->primaryKey()) {                                    echo $form->addInput(Clientes::primaryKeyName(), 'Input', ['type' => 'hidden'], [], false, true);                                }                                ?>                                <?php                                if (Session::get('action') == 'insert') {                                    echo $form->addInput('id_usuario', 'Input', ['type' => 'hidden', 'value' => Login::current()->id_usuario], [], false, true);                                }                                ?>                                <div class="panel panel-flat">                                    <div class="panel-heading">                                        <h5 class="panel-title">Cliente</h5>                                        <div class="panel-body">                                            <div class="col-md-12">                                                <div class="form-group">                                                    <div class="row">                                                        <?=                                                        $form->addInput('nome', 'Input',                                                            [],                                                            [                                                                'class' => ['col-md-4']                                                            ], false, true                                                        );                                                        ?>                                                        <?=                                                        $form->addInput('nome_fantasia', 'Input',                                                            [],                                                            [                                                                'class' => ['col-md-4']                                                            ], false, true                                                        );                                                        ?>                                                        <?=                                                        $form->addInput('razao_social', 'Input',                                                            [],                                                            [                                                                'class' => ['col-md-4']                                                            ], false, true                                                        );                                                        ?>                                                    </div>                                                </div>                                                <div class="form-group">                                                    <div class="row">                                                        <?= $form->addInput('inscricao_estadual', 'Input',                                                            [],                                                            [                                                                'class' => ['col-md-6']                                                            ], false, true                                                        ); ?>                                                        <?= $form->addInput('email', 'Input',                                                            [],                                                            [                                                                'class' => ['col-md-6']                                                            ], false, true                                                        ); ?>                                                    </div>                                                </div>                                                <div class="form-group">                                                    <div class="row">                                                        <?= $form->addInput('cnpj', 'Input',                                                            [],                                                            [                                                                'class' => ['col-md-6']                                                            ], false, true                                                        ); ?>                                                        <?= $form->addInput('cpf', 'Input',                                                            [],                                                            [                                                                'class' => ['col-md-6']                                                            ], false, true                                                        ); ?>                                                    </div>                                                </div>                                                <div class="form-group">                                                    <div class="row">                                                        <?= $form->addInput('rg', 'Input',                                                            [],                                                            [                                                                'class' => ['col-md-6']                                                            ], false, true                                                        ); ?>                                                        <?= $form->addInput('telefone', 'Input',                                                            [],                                                            [                                                                'class' => ['col-md-6']                                                            ], false, true                                                        ); ?>                                                    </div>                                                </div>                                                <div class="form-group">                                                    <div class="row">                                                        <?=                                                        $form->addInput('status', 'Boolui',                                                            [                                                                'value' => 1,                                                                'attrs' => [                                                                    'checked' => $model->status == 1 ? 'checked' : '',                                                                ],                                                            ],                                                            [                                                                'class' => ['col-md-12']                                                            ], false, true                                                        ); ?>                                                    </div>                                                </div>                                            </div>                                        </div>                                    </div>                                </div>                                <div class="panel panel-flat">                                    <div class="panel-heading">                                        <h5 class="panel-title">Endereço do cliente</h5>                                        <div class="panel-body">                                            <div class="col-md-12">                                                <?php                                                if ($endereco->primaryKey()) {                                                    echo $form_endereco->addInput(EnderecosClientes::primaryKeyName(), 'Input', ['type' => 'hidden'], [], false, true);                                                }                                                if ($endereco->primaryKey()) {                                                    echo $form_endereco->addInput('id_cliente', 'Input', ['type' => 'hidden'], [], false, true);                                                }                                                ?>                                                <div class="form-group">                                                    <div class="row">                                                        <?php $options = array2htmlselect((new Estados())                                                            ->select()                                                            ->from(['ESTADOS' => 'estados'])                                                            ->orderBy(ELOQUENT_ASC, 'ESTADOS.estado')                                                            ->execute(true), 'estado', 'id_estado');                                                        $options[''] = 'Selecione um estado';                                                        ksort($options);                                                        echo $form_endereco->addInput('id_estado', 'Select',                                                            [                                                                'options' => $options,                                                            ],                                                            [                                                                'class' => ['col-md-4'],                                                            ], false, true                                                        ); ?>                                                        <?php                                                        $options = ['' => 'Selecione um estado primeiro'];                                                        if (\Admin::isUpdate()) {                                                            $options = array2htmlselect((new Cidades())                                                                ->select()                                                                ->from(['CIDADES' => 'cidades'])                                                                ->where(ELOQUENT_EQUAL, ['CIDADES.id_estado', $endereco->id_estado])                                                                ->orderBy(ELOQUENT_ASC, 'CIDADES.cidade')                                                                ->execute(true), 'cidade', 'id_cidade');                                                            $options[''] = 'Selecione uma cidade';                                                        }                                                        ksort($options);                                                        echo $form_endereco->addInput('id_cidade', 'Select',                                                            [                                                                'options' => $options,                                                            ],                                                            [                                                                'class' => ['col-md-4'],                                                            ], false, true                                                        ); ?>                                                        <?php                                                        $options = ['' => 'Selecione uma cidade e estado'];                                                        if (\Admin::isUpdate()) {                                                            $options = array2htmlselect((new EnderecosClientes())                                                                ->select()                                                                ->from(['BAIRROS' => 'bairros'])                                                                ->where(ELOQUENT_EQUAL, ['BAIRROS.id_estado', $endereco->id_bairro])                                                                ->andWhere(ELOQUENT_EQUAL, ['BAIRROS.id_cidade', $endereco->id_cidade])                                                                ->orderBy(ELOQUENT_ASC, 'BAIRROS.nome')                                                                ->execute(true), 'nome', 'id_bairro');                                                            $options[''] = 'Selecione um bairro';                                                        }                                                        ksort($options);                                                        echo $form_endereco->addInput('id_bairro', 'Select',                                                            [                                                                'options' => $options,                                                            ],                                                            [                                                                'class' => ['col-md-4'],                                                            ], false, true                                                        ); ?>                                                    </div>                                                </div>                                                <div class="form-group">                                                    <div class="row">                                                        <?=                                                        $form_endereco->addInput('endereco', 'Input',                                                            [],                                                            [                                                                'class' => ['col-md-4']                                                            ], false, true                                                        );                                                        ?>                                                        <?=                                                        $form_endereco->addInput('numero', 'Input',                                                            [],                                                            [                                                                'class' => ['col-md-4']                                                            ], false, true                                                        );                                                        ?>                                                        <?=                                                        $form_endereco->addInput('complemento', 'Input',                                                            [],                                                            [                                                                'class' => ['col-md-4']                                                            ], false, true                                                        );                                                        ?>                                                    </div>                                                </div>                                                <div class="form-group">                                                    <div class="row">                                                        <?=                                                        $form_endereco->addInput('codigo_postal', 'Input',                                                            [],                                                            [                                                                'class' => ['col-md-12']                                                            ], false, true                                                        );                                                        ?>                                                    </div>                                                </div>                                                <div class="text-right mt-20">                                                    <?=                                                    $form->addInput(null, 'Button',                                                        [                                                            'text' => 'Enviar',                                                            'class' => [                                                                'btn',                                                                'bg-primary-400',                                                                'mt-20'                                                            ],                                                        ], [], false, true                                                    );                                                    ?>                                                </div>                                            </div>                                        </div>                                    </div>                                </div>                                <?php $form->end(); ?>                            </div>                        </div>                    </div>                </div>            </div>        </div>    </div><?php$this->html('_includes/end.content');